#creating and cleaning the data ----
total.val<-data.frame(category=c("House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel","House","House","Purchases","House","recreation","House","Auto","Auto","House","Education","HealthCare","HealthCare","Auto","Auto","Animal","recreation","recreation","House","Auto","Education","House","HealthCare","Others","Auto","Auto","Others","Food","Others","Cloths","Cloths","recreation","Incomes","Auto","Auto","Travel"),
                      type=c("Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros","Agua e esgoto","Aluguel","Amazon","Celular JP","Cinema","Coisas para casa","Compra do carro","Compra do carro - confirmar","Conta de luz","Curso JP","Dentista","Farmacia","Financiamento carro","Gasolina","Gatineos","Google music","Halloween","Internet - TV","Licenciamento carro","Livraria","Mercado","Oculos Erika e JP","Outros","Parking","Pedagio","Reembolso despesas","Refeicao na rua","saque","Roupa Erika","Roupa JP","Saida a noite","Salario","Seguro carro","Uber - Lyft","Viagem Key West e outros"),
                      value=c(-106.72,-1874,-125.52,-56.57,NA,NA,NA,NA,-54.29,NA,-644,-20.93,-338.86,NA,-24,-14.99,NA,NA,-79.76,-58.26,-373.53,-252.9,-10.99,-8,NA,101.64,-39.59,-80,-111.35,NA,-350.23,5516.59,-928,-23.9,NA,NA,NA,NA,NA,NA,-300,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-1874,NA,NA,NA,-597,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-242.51,NA,-2,NA,NA,NA,-18.84,NA,NA,NA,-31,NA,NA,NA,NA,NA,-3748,-400.86,NA,-34.42,-91.53,-3000,-2000,-191.25,NA,NA,NA,NA,NA,-25.77,NA,NA,-115.27,NA,NA,-1131.57,NA,-20,-6.5,NA,NA,-409.95,NA,-79.87,NA,-110.86,9110.44,NA,NA,NA,-25.09,-1874,-871.4,NA,NA,-33.37,NA,NA,-35.11,NA,NA,-5.29,-506.34,NA,-22.98,NA,NA,-104.72,NA,NA,-495.79,NA,-43.01,NA,-10,NA,-8.52,NA,-389.62,NA,NA,9097.73,-292.27,NA,-1154.67,-31.19,-1929,-189.67,-48.1,-23.16,NA,NA,NA,-46.36,-29,NA,-38.95,-338.86,-27.68,-52.98,-14.99,-25.4,-104.72,NA,NA,-1009.21,NA,-1.8,-2.85,-30,2203.79,-174.65,NA,-98,-272.13,-162.62,6011.42,-292.27,-27.62,398.21,-38.43,-1874,-76.32,-56.57,NA,-38.16,NA,NA,-45.59,-49,NA,NA,-338.86,-28.66,NA,-14.99,NA,-104.72,NA,-104.78,-943.44,NA,NA,NA,NA,NA,-37.6,NA,-160.4,-233.62,-323.41,6048.24,-292.27,-59.21,NA,NA,-1874,-635.4,-56.57,-33.6,NA,NA,NA,-45.5,NA,NA,NA,-338.86,-50.54,NA,-14.99,NA,-104.72,-32.54,-60.3,-571.94,NA,-12.56,NA,NA,NA,-222.66,-300,-183.29,NA,-226.28,5509.76,-292.27,-5,NA),
                      month=c("Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","Jan","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","May","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Jul","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Aug","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Sep","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Oct","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Nov","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec","Dec"),
                      year=c("2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016"))
#renaming category names
levels(total.val$category)<-c("pets","auto","clothes","education","food",
                              "health","house","income","others","purchases",
                              "recreation","travel")
total.val<-total.val[complete.cases(total.val),]
row.names(total.val)<-1:nrow(total.val)

#Income table
total.in<-total.val[total.val$value>0,]
total.in$category<-droplevels(total.in)$category
row.names(total.in)<-1:nrow(total.in)

#cost table
total.cost<-total.val[total.val$value<0,]
total.cost$category<-droplevels(total.cost)$category
row.names(total.cost)<-1:nrow(total.cost)

#Plotting chart --------------
#alltime sum of expenses
barplot(sort(tapply(total.cost$value,total.cost$category,sum)))



